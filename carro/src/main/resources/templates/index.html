<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Cadastro de Carros</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        nav {
            background-color: #333;
            padding: 10px;
            margin-bottom: 20px;
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 20px;
            margin: 0;
            padding: 0;
        }

        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: bold;
        }

        nav ul li a:hover {
            text-decoration: underline;
        }

        section {
            display: none;
        }

        section.active {
            display: block;
        }
    </style>
</head>

<body>
<nav>
    <ul>
        <li><a href="#" onclick="mostrarSecao('inicio')">üè† In√≠cio</a></li>
        <li><a href="#" onclick="mostrarSecao('carro')">üöó Cadastrar Carro</a></li>
        <li><a href="#" onclick="mostrarSecao('tipo')">üìã Cadastrar Tipo</a></li>
        <li><a href="#" onclick="mostrarSecao('listaCarros')">üìë Lista de Carros</a></li>
    </ul>
</nav>

<section id="inicio" class="active">
    <h1>Bem-vindo ao sistema de cadastro</h1>
    <p>Escolha uma op√ß√£o no menu acima.</p>
</section>

<section id="carro">
    <h2>Cadastrar Carro</h2>
    <form id="carroForm">
        <label>Placa:</label><br>
        <input type="text" name="placa" required><br><br>

        <label>Marca:</label><br>
        <input type="text" name="marca" required><br><br>

        <label>Modelo:</label><br>
        <input type="text" name="modelo" required><br><br>

        <label>Ano:</label><br>
        <input type="number" name="ano" required><br><br>

        <label>Cor:</label><br>
        <input type="text" name="cor"><br><br>

        <label>Km Rodados:</label><br>
        <input type="number" step="0.1" name="kmRodados"><br><br>

        <label>Valor Di√°ria:</label><br>
        <input type="number" step="0.01" name="valorDiaria"><br><br>

        <label>Dispon√≠vel:</label><br>
        <select name="disponivel">
            <option value="true">Sim</option>
            <option value="false">N√£o</option>
        </select><br><br>

        <label>Tipo:</label><br>
        <select id="tipoCarrosSelect" name="tipoCarros"></select><br><br>

        <button type="submit">Salvar Carro</button>
    </form>
</section>

<section id="tipo">
    <h2>Cadastrar Tipo de Carro</h2>
    <form id="tipoForm">
        <label>Nome do Tipo:</label><br>
        <input type="text" name="nome" required><br><br>
        <label>Descri√ß√£o:</label><br>
        <textarea name="descricao"></textarea><br><br>
        <button type="submit">Salvar Tipo</button>
    </form>
</section>

<section id="listaCarros">
    <h2>Lista de Carros</h2>
    <table id="carrosTable" border="1">
        <thead>
        <tr>
            <th>Placa</th>
            <th>Marca</th>
            <th>Modelo</th>
            <th>Ano</th>
            <th>Cor</th>
            <th>Km Rodados</th>
            <th>Valor Di√°ria</th>
            <th>Dispon√≠vel</th>
            <th>Tipo</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>

<script>
    const API_CARROS = '/api/carros';
    const API_TIPOS = '/api/tipoCarros';

    // troca de abas
    function mostrarSecao(id) {
        document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
        document.getElementById(id).classList.add("active");
    }

    document.addEventListener('DOMContentLoaded', () => {
        // carregar lista de carros
        if (document.getElementById('carrosTable')) {
            fetch(API_CARROS)
                .then(res => res.json())
                .then(data => {
                    const tbody = document.querySelector('#carrosTable tbody');
                    tbody.innerHTML = "";
                    data.forEach(carro => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
        <td>${carro.placa}</td>
        <td>${carro.marca}</td>
        <td>${carro.modelo}</td>
        <td>${carro.ano}</td>
        <td>${carro.cor}</td>
        <td>${carro.kmRodados}</td>
        <td>R$ ${carro.valorDiaria?.toFixed(2) || 0}</td>
        <td>${carro.disponivel ? 'Sim' : 'N√£o'}</td>
        <td>${carro.tipoCarros?.nome || 'N/A'}</td>
      `;
                        tbody.appendChild(row);
                    });
                });
        }

        // carregar op√ß√µes de tipoCarros no select
        if (document.getElementById('carroForm')) {
            const tipoSelect = document.getElementById('tipoCarrosSelect');
            fetch(API_TIPOS)
                .then(res => res.json())
                .then(tipos => {
                    tipoSelect.innerHTML = "";
                    tipos.forEach(tipo => {
                        const option = document.createElement('option');
                        option.value = tipo.id;
                        option.textContent = tipo.nome;
                        tipoSelect.appendChild(option);
                    });
                });

            // salvar carro
            document.getElementById('carroForm').addEventListener('submit', e => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const carro = {
                    placa: formData.get('placa'),
                    marca: formData.get('marca'),
                    modelo: formData.get('modelo'),
                    ano: parseInt(formData.get('ano')),
                    cor: formData.get('cor'),
                    kmRodados: parseFloat(formData.get('kmRodados')),
                    valorDiaria: parseFloat(formData.get('valorDiaria')),
                    disponivel: formData.get('disponivel') === 'true',
                    tipoCarros: { id: parseInt(formData.get('tipoCarros')) }
                };

                fetch(API_CARROS, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(carro)
                })
                    .then(res => res.json())
                    .then(() => {
                        alert('Carro cadastrado com sucesso!');
                        e.target.reset();
                    });
            });
        }

        // salvar tipo de carro
        if (document.getElementById('tipoForm')) {
            document.getElementById('tipoForm').addEventListener('submit', e => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const tipo = {
                    nome: formData.get('nome'),
                    descricao: formData.get('descricao')
                };

                fetch(API_TIPOS, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(tipo)
                })
                    .then(res => res.json())
                    .then(() => {
                        alert('Tipo cadastrado com sucesso!');
                        e.target.reset();
                    });
            });
        }
    });
</script>
</body>

</html>